# 安装和使用指南

## 系统要求

- **操作系统**: Windows 10/11
- **Python版本**: Python 3.8 或更高
- **磁盘空间**: 至少 100MB 可用空间

## 快速开始

### 方法一：使用批处理文件（推荐，简单快捷）

1. **安装依赖**
   - 双击运行 `安装依赖.bat`
   - 等待所有依赖库安装完成

2. **启动程序**
   - 双击运行 `启动监控.bat`
   - 程序将自动启动监控服务和Web界面

3. **访问Web界面**
   - 打开浏览器访问: `http://localhost:5000`
   - 查看实时数据和统计报表

### 方法二：使用命令行

1. **打开命令提示符（CMD）或PowerShell**

2. **进入项目目录**
   ```bash
   cd D:\DESKTOP\学术\研究\【code】\1
   ```

3. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

4. **启动程序**
   ```bash
   python main.py
   ```

5. **访问Web界面**
   - 打开浏览器访问: `http://localhost:5000`

## 设置开机自启动

### 使用自动配置脚本（推荐）

1. 运行自启动配置工具：
   ```bash
   python setup_autostart.py
   ```

2. 选择选项 `1` 设置开机自启动

3. 重启电脑验证

### 手动设置

1. 按 `Win + R` 打开运行对话框

2. 输入 `shell:startup` 并按回车

3. 在打开的启动文件夹中创建快捷方式：
   - 右键 → 新建 → 快捷方式
   - 目标位置: `python.exe "完整路径\main.py"`
   - 名称: 系统监控程序

4. 重启电脑验证

## 功能使用

### 1. 实时监控

程序启动后会自动开始监控：
- 鼠标活动（移动、点击）
- 键盘活动（按键次数）
- 窗口切换
- 系统资源使用

数据每分钟自动保存一次，关机时会保存最后的数据。

### 2. 查看统计

访问 Web 界面可以查看：

- **📅 今日概览**: 当天的活动数据和忙碌度曲线
- **📊 本周报表**: 近7天的统计分析和趋势图
- **📈 本月报表**: 本月的活动热力图和统计
- **🔍 自定义分析**: 选择任意时间段进行分析
- **💾 数据导出**: 导出CSV或Excel格式的报表

### 3. 数据导出

1. 在Web界面点击"数据导出"标签
2. 选择开始和结束日期
3. 选择导出格式：
   - **CSV**: 原始数据，适合进一步分析
   - **Excel**: 包含汇总统计，更直观

导出的文件保存在 `data` 目录下。

## 数据说明

### 监控指标

- **鼠标活动**: 
  - 移动距离（像素）
  - 点击次数
  - 移动频率

- **键盘活动**:
  - 按键次数
  - 打字速度（每分钟按键数）

- **窗口管理**:
  - 窗口切换次数
  - 活动窗口标题

- **系统状态**:
  - CPU使用率
  - 内存使用率

### 忙碌指数计算

忙碌指数范围 0-100，综合考虑：

| 指标 | 权重 |
|-----|------|
| 鼠标活动 | 30% |
| 键盘活动 | 30% |
| 窗口切换 | 20% |
| 系统资源 | 20% |

指数说明：
- **0-20**: 空闲/午休
- **20-40**: 低强度活动
- **40-60**: 中等强度工作
- **60-80**: 高强度工作
- **80-100**: 极高强度工作

### 作息分析

程序会自动识别：
- **开机时间**: 每日最早的活动时间
- **关机时间**: 最后的活动时间
- **午休时段**: 12:00-14:00 之间的空闲时间
- **长时间空闲**: 连续30分钟无活动

## 常见问题

### Q1: 程序无法启动

**A**: 检查以下几点：
1. 确认已安装Python 3.8+
2. 确认已安装所有依赖库
3. 查看 `logs/monitor.log` 日志文件
4. 确保端口5000未被占用

### Q2: 数据不准确

**A**: 
1. 确保监控服务持续运行
2. 检查是否有多个程序实例
3. 查看日志确认是否有错误

### Q3: Web界面无法访问

**A**:
1. 确认程序正在运行
2. 尝试访问 `http://127.0.0.1:5000`
3. 检查防火墙设置
4. 更换端口（修改 `config.py` 中的 `WEB_PORT`）

### Q4: 自启动不生效

**A**:
1. 确认快捷方式在启动文件夹中
2. 检查快捷方式的目标路径是否正确
3. 查看系统日志确认程序是否启动

### Q5: 占用系统资源过高

**A**:
1. 监控间隔默认为60秒，可在 `config.py` 中调整
2. 定期清理旧数据（默认保留365天）
3. 关闭不需要的监控功能

## 数据隐私

✅ **所有数据存储在本地**
- 数据库文件: `data/activity.db`
- 不会上传到任何服务器
- 可随时删除或导出数据

✅ **监控内容**
- 仅记录活动统计数据
- 不记录具体按键内容
- 窗口标题用于分析，不监控内容

✅ **数据安全**
- SQLite 本地数据库
- 可加密存储（高级功能）
- 支持数据备份和恢复

## 卸载程序

1. 移除开机自启动：
   ```bash
   python setup_autostart.py
   ```
   选择选项 `2` 移除自启动

2. 删除程序文件夹

3. （可选）删除以下位置的快捷方式：
   ```
   %APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup
   ```

## 技术支持

如遇到问题：

1. 查看日志文件: `logs/monitor.log`
2. 检查 README.md 中的故障排除部分
3. 提交 Issue 或联系开发者

## 更新日志

### v1.0.0 (2025-10)
- ✨ 首次发布
- ✅ 实时监控功能
- ✅ Web 可视化界面
- ✅ 数据分析和报表
- ✅ 开机自启动支持
- ✅ 数据导出功能

## 许可证

MIT License - 详见 LICENSE 文件

---

**祝使用愉快！如有问题欢迎反馈。** 📊✨

