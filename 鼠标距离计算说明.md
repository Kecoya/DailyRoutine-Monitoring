# 鼠标移动距离计算说明

## 📐 计算原理

### 1. 距离测量方法
系统使用**欧几里得距离公式**（勾股定理）计算鼠标两次采样点之间的直线距离：

```python
distance = √[(x2 - x1)² + (y2 - y1)²]
```

**示例：**
```
起点: (100, 200)
终点: (400, 600)
距离 = √[(400-100)² + (600-200)²]
     = √[300² + 400²]
     = √[90000 + 160000]
     = √250000
     = 500 像素
```

### 2. 单位换算

原始测量单位是**屏幕像素**，需要换算为实际物理距离。

#### 当前换算系数
```python
PIXELS_PER_METER = 3600  # 像素/米
```

这个值基于**典型24寸 1920×1080显示器**：
- 屏幕宽度：约53厘米 = 0.53米
- 水平分辨率：1920像素
- 换算：1920像素 ÷ 0.53米 ≈ 3623像素/米
- 取整为：**3600像素/米**

**物理意义：**
- 1像素 ≈ 0.28毫米
- 1000像素 ≈ 27.8厘米
- 3600像素 = 1米

## ⚠️ 测量限制

### 限制1：采样间隔导致的误差

**问题：** 鼠标监听器不会捕捉每一个像素的移动，而是定期采样。

**影响：**
```
实际轨迹：A → B → C → D → E  (曲线，总长度较长)
测量轨迹：A ---------------→ E  (直线，测量值较短)
```

**结果：** 实际测量值会**略小于**真实移动距离（特别是快速移动时）

### 限制2：显示器差异

不同显示器的物理尺寸和分辨率不同：

| 显示器规格 | 分辨率 | 宽度(cm) | 像素/米 |
|-----------|--------|---------|---------|
| 24寸 FHD | 1920×1080 | 53 | ~3600 |
| 27寸 FHD | 1920×1080 | 60 | ~3200 |
| 27寸 2K | 2560×1440 | 60 | ~4267 |
| 32寸 4K | 3840×2160 | 70 | ~5486 |

**当前配置适用于：**
- 24-27寸的1920×1080显示器
- 误差范围：±20%

### 限制3：显示缩放

Windows显示缩放（125%、150%等）会影响坐标系统：
- 100%缩放：1像素 = 1逻辑像素
- 125%缩放：1.25像素 = 1逻辑像素
- 150%缩放：1.5像素 = 1逻辑像素

**注意：** 当前测量使用的是**逻辑像素**，不考虑DPI缩放。

## 🔧 如何调整换算系数

### 方法1：测量你的显示器（推荐）

**步骤：**
1. 测量显示器的实际显示宽度（不含边框）
   - 例如：我的显示器宽53厘米

2. 查看屏幕分辨率
   - 右键桌面 → 显示设置 → 查看分辨率
   - 例如：1920×1080

3. 计算换算系数
   ```
   PIXELS_PER_METER = 水平分辨率 ÷ (宽度cm ÷ 100)
   
   例如：
   1920 ÷ (53 ÷ 100) = 1920 ÷ 0.53 ≈ 3623
   取整为 3600
   ```

4. 修改配置文件 `config.py`：
   ```python
   PIXELS_PER_METER = 3623  # 改为你计算的值
   ```

### 方法2：根据显示器规格估算

常见显示器的参考值：

```python
# 24寸 1920×1080
PIXELS_PER_METER = 3600

# 27寸 1920×1080
PIXELS_PER_METER = 3200

# 27寸 2560×1440
PIXELS_PER_METER = 4300

# 32寸 3840×2160
PIXELS_PER_METER = 5500
```

### 方法3：实测校准（最准确）

1. 在桌面放一把尺子
2. 将鼠标从屏幕最左边移动到最右边（沿着尺子）
3. 记录显示的距离和尺子的实际距离
4. 调整系数：
   ```
   新系数 = 旧系数 × (显示距离 ÷ 实际距离)
   ```

## 📊 典型数值参考

### 一天的鼠标移动距离

根据工作类型，一天的鼠标移动距离大致范围：

| 工作类型 | 预估距离 |
|---------|---------|
| 文字工作（写作、阅读）| 50-200米 |
| 编程开发 | 200-500米 |
| 设计、视频编辑 | 500-1000米 |
| 游戏、频繁操作 | 1000-3000米+ |

**验证方法：**
如果你的日常数据严重偏离这些范围，可能需要调整换算系数。

### 快速验证

在屏幕上移动鼠标：
- 从左边缘到右边缘：约0.5米（对于24寸显示器）
- 从上边缘到下边缘：约0.3米（对于24寸显示器）
- 绕屏幕一圈：约1.6米

## 💡 使用建议

### 1. 关注相对变化，而非绝对值

即使换算系数不完全准确，日常对比仍然有意义：
- 今天比昨天多移动了20%
- 本周平均移动距离比上周增加了

### 2. 结合其他指标

鼠标移动距离应该结合其他指标一起看：
- **移动距离大 + 点击次数多** = 操作密集型工作
- **移动距离大 + 点击次数少** = 浏览、阅读
- **移动距离小 + 键盘按键多** = 文字输入工作

### 3. 个性化基准

建立自己的基准：
- 记录一周的正常工作数据
- 找出自己的平均值
- 以此为标准进行对比

## 🔬 技术细节

### 为什么不用实际轨迹长度？

**理论上**可以记录鼠标的完整轨迹，累加每个像素的移动：
```python
# 理论上的完整轨迹
total_distance = 每次移动1像素的累加
```

**实际问题：**
1. **性能消耗巨大**：需要捕捉每次鼠标移动事件（每秒数百次）
2. **存储压力**：需要保存大量坐标点
3. **精度有限**：操作系统本身就是采样，不是连续的

**当前方案**：
- 每分钟采样一次（60秒间隔）
- 记录采样点之间的直线距离
- 在性能和精度之间取得平衡

### 多显示器情况

如果使用多显示器：
- 坐标系统会跨越所有显示器
- 不同显示器的像素密度可能不同
- 当前方案使用统一的换算系数（会有误差）
- **建议**：以主显示器为准设置换算系数

## 📝 总结

**优点：**
- ✅ 计算方法科学合理（欧几里得距离）
- ✅ 可配置换算系数，适应不同显示器
- ✅ 性能开销小
- ✅ 相对变化准确

**局限：**
- ⚠️ 采样导致的测量偏小（系统性误差）
- ⚠️ 不同显示器需要不同配置
- ⚠️ 多显示器环境有误差
- ⚠️ 不考虑DPI缩放

**建议：**
- 根据自己的显示器调整 `PIXELS_PER_METER` 配置
- 关注相对趋势，而非绝对数值
- 结合其他指标综合分析工作状态

---

**配置文件位置：** `config.py` 第57行
```python
PIXELS_PER_METER = 3600  # 根据你的显示器修改此值
```

